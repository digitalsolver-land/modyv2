<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moody - Suggestions</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background-color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .nav-links {
            display: flex;
        }
        
        .nav-link {
            padding: 8px 16px;
            margin-left: 10px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        .nav-link:hover {
            background-color: #f0f0f0;
        }
        
        .nav-link.active {
            border-bottom: 2px solid #4CAF50;
            color: #4CAF50;
        }
        
        .logout-btn {
            padding: 8px 16px;
            margin-left: 20px;
            border: 1px solid #e74c3c;
            background: none;
            color: #e74c3c;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            background-color: #e74c3c;
            color: white;
        }
        
        .main-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            margin-top: 0;
            text-align: center;
        }
        
        .suggestions-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (min-width: 768px) {
            .suggestions-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (min-width: 1024px) {
            .suggestions-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        .suggestion-card {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 3px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .suggestion-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .suggestion-card h3 {
            margin-top: 0;
            color: #4CAF50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .suggestion-card p {
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .mood-summary {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f0f7ff;
            border-radius: 8px;
        }
        
        .mood-emoji {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        .mood-text {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .activities-list {
            list-style-type: none;
            padding: 0;
        }
        
        .activities-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #ddd;
        }
        
        .activities-list li:last-child {
            border-bottom: none;
        }
        
        .activities-list li:before {
            content: "‚Üí ";
            color: #4CAF50;
        }
        
        .quote {
            font-style: italic;
            color: #666;
            text-align: center;
            margin: 30px 0;
            padding: 15px;
            border-left: 3px solid #4CAF50;
            background-color: #f9f9f9;
        }
        
        .back-btn {
            display: block;
            width: fit-content;
            margin: 30px auto 0;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .back-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">MOODY</div>
            <div class="nav-links">
                <button class="nav-link" onclick="window.location.href='/dashboard'">Tableau de bord</button>
                <button class="nav-link" onclick="window.location.href='/analysis'">Analyse</button>
                <button class="nav-link active">Suggestions</button>
                <button class="nav-link" onclick="window.location.href='/profile'">Profil</button>
            </div>
            <button class="logout-btn">D√©connexion</button>
        </div>
        
        <div class="main-content">
            <h1>Suggestions pour am√©liorer votre humeur</h1>
            
            <div class="mood-summary">
                <div class="mood-emoji" id="mood-emoji">üòä</div>
                <div class="mood-text" id="mood-text">Bas√© sur votre entr√©e d'aujourd'hui, votre humeur semble positive.</div>
            </div>
            
            <div class="suggestions-container" id="suggestions-list">
                <!-- Les suggestions seront g√©n√©r√©es par JavaScript -->
            </div>
            
            <div class="quote" id="quote">
                "Le bonheur n'est pas quelque chose de pr√™t √† l'emploi. Il d√©coule de vos propres actions." - Dalai Lama
            </div>
            
            <a href="/dashboard" class="back-btn">Retour au tableau de bord</a>
        </div>
    </div>
    
    <script>
        // R√©cup√©rer l'humeur actuelle de l'utilisateur depuis l'API
        async function fetchLatestMood() {
            try {
                const response = await fetch('/api/get_latest_mood');
                const data = await response.json();
                
                if (data.success && data.mood) {
                    updateMoodDisplay(data.mood);
                    generateSuggestions(data.mood);
                } else {
                    // Si aucune humeur n'est enregistr√©e
                    document.getElementById('mood-emoji').textContent = 'üòê';
                    document.getElementById('mood-text').textContent = 'Vous n\'avez pas encore enregistr√© votre humeur aujourd\'hui.';
                    generateDefaultSuggestions();
                }
            } catch (error) {
                console.error('Erreur lors de la r√©cup√©ration de l\'humeur:', error);
                generateDefaultSuggestions();
            }
        }
        
        // Mettre √† jour l'affichage de l'humeur
        function updateMoodDisplay(mood) {
            const emojiElement = document.getElementById('mood-emoji');
            const textElement = document.getElementById('mood-text');
            
            // D√©finir l'emoji en fonction de l'humeur enregistr√©e
            switch(mood.emoji) {
                case 'very_happy':
                    emojiElement.textContent = 'üòÑ';
                    textElement.textContent = 'Votre humeur est tr√®s positive aujourd\'hui. C\'est fantastique!';
                    break;
                case 'happy':
                    emojiElement.textContent = 'üôÇ';
                    textElement.textContent = 'Vous vous sentez plut√¥t bien aujourd\'hui.';
                    break;
                case 'neutral':
                    emojiElement.textContent = 'üòê';
                    textElement.textContent = 'Votre humeur est neutre aujourd\'hui.';
                    break;
                case 'sad':
                    emojiElement.textContent = 'üòî';
                    textElement.textContent = 'Vous semblez un peu triste aujourd\'hui.';
                    break;
                case 'very_sad':
                    emojiElement.textContent = 'üò¢';
                    textElement.textContent = 'Votre humeur est assez basse aujourd\'hui.';
                    break;
                case 'angry':
                    emojiElement.textContent = 'üò°';
                    textElement.textContent = 'Vous semblez en col√®re aujourd\'hui.';
                    break;
                case 'tired':
                    emojiElement.textContent = 'üò¥';
                    textElement.textContent = 'Vous vous sentez fatigu√©(e) aujourd\'hui.';
                    break;
                case 'anxious':
                    emojiElement.textContent = 'üò∞';
                    textElement.textContent = 'Vous semblez anxieux(se) aujourd\'hui.';
                    break;
                default:
                    emojiElement.textContent = 'üòê';
                    textElement.textContent = 'Humeur enregistr√©e aujourd\'hui.';
            }
        }
        
        // G√©n√©rer des suggestions bas√©es sur l'humeur
        function generateSuggestions(mood) {
            const suggestionsContainer = document.getElementById('suggestions-list');
            suggestionsContainer.innerHTML = ''; // Effacer les suggestions existantes
            
            // D√©finir les suggestions en fonction de l'humeur
            let suggestions = [];
            
            if (['very_happy', 'happy'].includes(mood.emoji)) {
                // Suggestions pour humeur positive
                suggestions = [
                    {
                        title: 'Maintenez cette √©nergie positive',
                        content: 'Votre humeur est bonne, c\'est le moment id√©al pour accomplir des t√¢ches qui demandent de la cr√©ativit√© ou pour aider les autres.',
                        activities: [
                            'Essayez une nouvelle activit√© cr√©ative',
                            'Partagez votre positivit√© avec un ami ou un coll√®gue',
                            'Prenez des d√©cisions importantes pendant que votre esprit est clair'
                        ]
                    },
                    {
                        title: 'Expression de gratitude',
                        content: 'Prendre le temps d\'appr√©cier les bonnes choses dans votre vie peut renforcer encore plus votre bonne humeur.',
                        activities: [
                            '√âcrivez trois choses pour lesquelles vous √™tes reconnaissant(e)',
                            'Exprimez votre appr√©ciation √† quelqu\'un',
                            'Prenez des photos de moments ou de choses qui vous rendent heureux(se)'
                        ]
                    },
                    {
                        title: 'Objectifs personnels',
                        content: 'Utilisez cette √©nergie positive pour faire avancer vos projets personnels.',
                        activities: [
                            'Travaillez sur un projet qui vous passionne',
                            'Fixez-vous un nouvel objectif √† atteindre',
                            'Faites le point sur vos r√©alisations r√©centes'
                        ]
                    }
                ];
                // Citation positive
                document.getElementById('quote').textContent = '"Le bonheur est la seule chose qui se double si vous le partagez." - Albert Schweitzer';
            } else if (mood.emoji === 'neutral') {
                // Suggestions pour humeur neutre
                suggestions = [
                    {
                        title: 'Stimulez votre humeur',
                        content: 'Votre humeur est neutre, c\'est un bon moment pour essayer des activit√©s qui pourraient la rehausser l√©g√®rement.',
                        activities: [
                            '√âcoutez votre musique pr√©f√©r√©e',
                            'Faites une courte promenade √† l\'ext√©rieur',
                            'Mangez quelque chose que vous aimez'
                        ]
                    },
                    {
                        title: 'Engagement et concentration',
                        content: 'C\'est un bon moment pour les t√¢ches qui demandent de la concentration.',
                        activities: [
                            'Fixez-vous un petit d√©fi intellectuel',
                            'Organisez votre espace de travail ou votre maison',
                            'Apprenez quelque chose de nouveau sur un sujet qui vous int√©resse'
                        ]
                    },
                    {
                        title: 'Connexion sociale l√©g√®re',
                        content: 'Des interactions sociales simples peuvent aider √† am√©liorer votre humeur.',
                        activities: [
                            'Envoyez un message √† un ami que vous n\'avez pas contact√© r√©cemment',
                            'Partagez une anecdote amusante avec un coll√®gue',
                            'Appelez un membre de votre famille pour prendre de ses nouvelles'
                        ]
                    }
                ];
                // Citation neutre
                document.getElementById('quote').textContent = '"La vie n\'est ni bonne ni mauvaise, c\'est l\'endroit o√π l\'on apprend." - Confucius';
            } else if (['sad', 'very_sad', 'anxious'].includes(mood.emoji)) {
                // Suggestions pour humeur n√©gative
                suggestions = [
                    {
                        title: 'Prendre soin de soi',
                        content: 'Quand l\'humeur est basse, il est important de prendre soin de vous-m√™me avec compassion.',
                        activities: [
                            'Prenez un bain chaud ou une douche relaxante',
                            'Buvez une tisane ou votre boisson chaude pr√©f√©r√©e',
                            'Enveloppez-vous dans une couverture confortable et reposez-vous'
                        ]
                    },
                    {
                        title: 'Exercice doux',
                        content: 'L\'activit√© physique peut aider √† lib√©rer des endorphines et √† am√©liorer votre humeur.',
                        activities: [
                            'Faites une courte marche dehors si possible',
                            'Essayez quelques √©tirements doux ou du yoga',
                            'Dansez sur votre chanson pr√©f√©r√©e pendant quelques minutes'
                        ]
                    },
                    {
                        title: 'Distraction positive',
                        content: 'D√©tourner temporairement votre attention des pens√©es n√©gatives peut √™tre b√©n√©fique.',
                        activities: [
                            'Regardez une com√©die ou une vid√©o amusante',
                            'Lisez un livre ou un magazine l√©ger',
                            'Appelez un ami qui vous fait g√©n√©ralement sourire'
                        ]
                    }
                ];
                // Citation pour humeur basse
                document.getElementById('quote').textContent = '"M√™me la nuit la plus sombre prendra fin et le soleil se l√®vera." - Victor Hugo';
            } else if (mood.emoji === 'angry') {
                // Suggestions pour la col√®re
                suggestions = [
                    {
                        title: 'Techniques de calme',
                        content: 'Quand vous √™tes en col√®re, des m√©thodes pour vous calmer peuvent aider √† g√©rer cette √©motion intense.',
                        activities: [
                            'Pratiquez la respiration profonde pendant 5 minutes',
                            '√âcrivez ce qui vous met en col√®re sur un papier, puis d√©chirez-le',
                            'Comptez lentement jusqu\'√† 10 avant de r√©agir √† ce qui vous √©nerve'
                        ]
                    },
                    {
                        title: 'Lib√©ration d\'√©nergie',
                        content: 'La col√®re g√©n√®re de l\'√©nergie qui peut √™tre canalis√©e de fa√ßon productive.',
                        activities: [
                            'Faites un exercice physique intense comme courir ou frapper dans un coussin',
                            'Rangez ou nettoyez votre espace de mani√®re √©nergique',
                            'Allez dans un endroit priv√© et criez si n√©cessaire'
                        ]
                    },
                    {
                        title: 'Perspective et r√©flexion',
                        content: 'Apr√®s vous √™tre calm√©(e), r√©fl√©chir √† la situation peut √™tre utile.',
                        activities: [
                            'Consid√©rez la situation du point de vue de l\'autre personne',
                            'R√©fl√©chissez √† ce que vous avez appris de cette exp√©rience',
                            'Pensez √† comment vous aimeriez g√©rer une situation similaire √† l\'avenir'
                        ]
                    }
                ];
                // Citation pour la col√®re
                document.getElementById('quote').textContent = '"La col√®re est une courte folie. Ma√Ætrisez votre passion ou elle vous ma√Ætrisera." - Horace';
            } else if (mood.emoji === 'tired') {
                // Suggestions pour la fatigue
                suggestions = [
                    {
                        title: 'Repos et r√©cup√©ration',
                        content: 'Votre corps vous signale qu\'il a besoin de repos, √©coutez-le.',
                        activities: [
                            'Faites une sieste courte de 20 minutes si possible',
                            'Allez vous coucher plus t√¥t ce soir',
                            'Cr√©ez une routine relaxante pour la soir√©e'
                        ]
                    },
                    {
                        title: '√ânergie naturelle',
                        content: 'Il existe des moyens naturels de stimuler votre √©nergie sans caf√©ine excessive.',
                        activities: [
                            'Buvez un grand verre d\'eau - la d√©shydratation peut causer de la fatigue',
                            'Mangez une collation riche en prot√©ines',
                            'Ouvrez une fen√™tre pour de l\'air frais ou faites une courte promenade'
                        ]
                    },
                    {
                        title: 'Ajustement des attentes',
                        content: 'Quand vous √™tes fatigu√©(e), il est important d\'adapter vos activit√©s.',
                        activities: [
                            'Reportez les t√¢ches qui demandent beaucoup de concentration',
                            'Divisez les grandes t√¢ches en petites √©tapes g√©rables',
                            'Donnez-vous la permission de faire moins aujourd\'hui'
                        ]
                    }
                ];
                // Citation pour la fatigue
                document.getElementById('quote').textContent = '"Le repos est un excellent m√©dicament." - Proverbe fran√ßais';
            } else {
                // Suggestions par d√©faut
                generateDefaultSuggestions();
                return;
            }
            
            // Ajouter les suggestions au conteneur
            suggestions.forEach(suggestion => {
                const card = document.createElement('div');
                card.className = 'suggestion-card';
                
                let activitiesHTML = '';
                if (suggestion.activities && suggestion.activities.length > 0) {
                    activitiesHTML = '<ul class="activities-list">';
                    suggestion.activities.forEach(activity => {
                        activitiesHTML += `<li>${activity}</li>`;
                    });
                    activitiesHTML += '</ul>';
                }
                
                card.innerHTML = `
                    <h3>${suggestion.title}</h3>
                    <p>${suggestion.content}</p>
                    ${activitiesHTML}
                `;
                
                suggestionsContainer.appendChild(card);
            });
        }
        
        // G√©n√©rer des suggestions par d√©faut
        function generateDefaultSuggestions() {
            const suggestionsContainer = document.getElementById('suggestions-list');
            suggestionsContainer.innerHTML = ''; // Effacer les suggestions existantes
            
            const defaultSuggestions = [
                {
                    title: 'Activit√©s de pleine conscience',
                    content: 'Pratiquez la pleine conscience pour vous ancrer dans le moment pr√©sent.',
                    activities: [
                        'Essayez une m√©ditation guid√©e de 5 minutes',
                        'Pratiquez la respiration profonde pendant quelques minutes',
                        'Observez attentivement votre environnement √† travers vos cinq sens'
                    ]
                },
                {
                    title: 'Prendre soin de son corps',
                    content: 'Votre corps et votre esprit sont connect√©s, prendre soin de l\'un aide l\'autre.',
                    activities: [
                        'Faites une activit√© physique l√©g√®re comme une marche',
                        'Buvez suffisamment d\'eau tout au long de la journ√©e',
                        'Pr√©parez-vous un repas nutritif et savoureux'
                    ]
                },
                {
                    title: 'Connexion sociale',
                    content: 'Les interactions sociales positives sont essentielles pour notre bien-√™tre.',
                    activities: [
                        'Appelez un ami ou un membre de la famille',
                        '√âcrivez un message de gratitude √† quelqu\'un',
                        'Rejoignez une activit√© de groupe qui vous int√©resse'
                    ]
                }
            ];
            
            // Ajouter les suggestions au conteneur
            defaultSuggestions.forEach(suggestion => {
                const card = document.createElement('div');
                card.className = 'suggestion-card';
                
                let activitiesHTML = '';
                if (suggestion.activities && suggestion.activities.length > 0) {
                    activitiesHTML = '<ul class="activities-list">';
                    suggestion.activities.forEach(activity => {
                        activitiesHTML += `<li>${activity}</li>`;
                    });
                    activitiesHTML += '</ul>';
                }
                
                card.innerHTML = `
                    <h3>${suggestion.title}</h3>
                    <p>${suggestion.content}</p>
                    ${activitiesHTML}
                `;
                
                suggestionsContainer.appendChild(card);
            });
        }
        
        // G√©rer la d√©connexion
        document.querySelector('.logout-btn').addEventListener('click', async function() {
            try {
                const response = await fetch('/api/logout', {
                    method: 'POST',
                });
                const data = await response.json();
                if (data.success) {
                    window.location.href = data.redirect || '/';
                }
            } catch (error) {
                console.error('Erreur lors de la d√©connexion:', error);
                window.location.href = '/';
            }
        });
        
        // Charger les suggestions au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            fetchLatestMood();
        });
    </script>
</body>
</html>